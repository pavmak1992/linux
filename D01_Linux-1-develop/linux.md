# D01_Linux

## Part 1. Установка ОС
- ![](images/1-1.png)  
Узнали версию Ubuntu, выполнив команду `cat /etc/issue`.

<br>


## Part 2. Создание пользователя

- ![](images/2-1.png)  
Использовали команду adduser для создания нового пользователя `rubinlal2`.

<br>

- ![](images/2-2.png)  
Добавили пользователя в группу командой `sudo usermod -aG adm newusername`.

<br>

- ![](images/2-3.png)  
Проверили, что пользователь добавлен в нужную группу.

<br>

- ![](images/2-4.png)  
Убеждаемся, что новый пользователь есть в выводе команды
`cat /etc/passwd`.

<br>

## Part 3. Настройка сети ОС

- ![](images/3-1.png)  
Задали название машины вида `user-2`.

<br>

- ![](images/3-2.png)  
Проверили, что название машины изменилось.

<br>

- ![](images/3-3.png)  
Установили текущую временную зону командой `sudo timedatectl set-timezone Europe/Moscow` и проверили ее.


<br>

- ![](images/3-4.png)  
Вывели названия сетевых интерфейсов командой `ip a`.

- lo - используется для отладки сетевых программ и запуска серверных приложений на локальной машине.

<br>

- ![](images/3-111.png)  
Получили ip адрес устройства, на котором работаем, от DHCP сервера. Команда `sudo dhclient -v`. 

- DHCP - Dynamic Host Configuration Protocol (Протокол динамической конфигурации узла) - сетевой протокол, используемый для автоматической конфигурации устройств, подключенных к сети, включая назначение IP-адресов, сетевых масок, шлюзов и других параметров.

<br>

- ![](images/3-7.png)  
Определили внутренний IP-адрес шлюза (gw/gateway).

<br>

- ![](images/3-5.png)  
Определили внешний ip-адрес шлюза (ip).

<br>

- ![](images/3-11.png)  
Открываем файл конфигурации Netplan для редактирования.

<br>

- ![](images/3-12.png)  
1. Установили значение dhcp4 на false - отключили протокол DHCP (чтобы указать статический ip адрес интерфейса).
2. В addresses установили статический ip адрес сервера.
3. В gateway4 указываем шлюз.
4. В nameservers указали DNS (ip адреса серверов имен). DNS Google - имеет адрес 8.8.8.8.

<br>

- ![](images/3-13.png)  
Применили конфигурацию Netplan.

<br>

- ![](images/3-15.png)  
Перезагрузили систему.

<br>

- ![](images/3-13-1.png)  
Выводим на экран внутренний IP-адрес шлюза командой `ip route`.

<br>

- ![](images/3-16.png)
Пингуем удаленные хосты 1.1.1.1 и ya.ru.

<br>

## Part 4. Обновление ОС

- ![](images/4-1.png)
Проверка актуальности системных пакетов.

<br>

- ![](images/4-2.png)
Обновление системных пакетов командой `sudo apt full-upgrade`.

<br>

## Part 5. Использование команды sudo

- ![](images/5-1.png)  
Разрешили пользователю созданному в part 2 выполнять команду `sudo` - расшифровывается как "superuser do". Позволяет пользователю выполнять команды с привилегиями суперпользователя, что дает доступ к выполнению административных задач и команд, которые обычный пользователь не может выполнить.

<br>

- ![](images/5-2.png)  
Сменили текущего пользователя командой `su`.

<br>

- ![](images/5-3.png)  
Поменяли hostname os от имени rubinlal2.

## Part 6. Установка и настройка службы времени

- ![](images/6-2.png)  
Проверили, что время синхронизируется автоматически командой `timedatectl show`.

## Part 7. Установка и использование текстовых редакторов

### VIM

- ![](images/7-1.png)  
Создаем текстовый файл и открываем его в vim.

<br>

- ![](images/7-2.png)  
Нажимаем `i` для режима редактирования и вписываем ник. Жмем `Esc` для выхода из режима редактирования и прописываем `:wq` для сохранения и выхода.

<br>

- ![](images/7-3.png)  
Открываем снова этот файл `sudo vim text_vim.txt`, редактируем и выходим без сохранения `:q!`.

- ![](images/7-4.png)  
Редактируем файл, нажимаем `/` и осуществляем поиск.

<br>

- ![](images/7-5.png)  
Делаем замену слова командой `:s/слово/замена`.

<br>

### NANO

- ![](images/7-6.png)  
Создаем файл и открываем с помощью nano.

<br>

- ![](images/7-7.png)  
Пишем ник, жмем `ctrl+o` и соглашаемся с выбором. Далее `ctrl+x` для выхода.

<br>

- ![](images/7-8.png)  
Редактируем файл, жмем `ctrl+x`, не соглашаемся, чтобы не сохранять изменения.

<br>

- ![](images/7-9.png)  
Для поиска слова нажимаем `ctrl+w`.

<br>

- ![](images/7-10.png)  
Далее для замены слова на другое жмем `ctrl+\`. Вводим искомое слово, потом заменяемое.

<br>

### MCEDIT

- ![](images/7-11.png)  
Установили редактор mcedit вместе с пакетом mc.

<br>

- ![](images/7-12.png)  
Создали файл и открыли с помощью mcedit.

<br>

- ![](images/7-13.png)
Отредактировали файл, жмем `f10` и подтверждаем выход с сохранением.

<br>

- ![](images/7-14.png)  
Отредактировали файл, жмем `f10` и подтверждаем выход без сохранения.

<br>

- ![](images/7-15.png)  
Жмем `f7` для поиска нужного слова.

<br>

- ![](images/7-16.png)  
`f4` для замены слова на другое.

## Part 8. Установка и базовая настройка сервиса SSHD

- ![](images/8-1.png)  
Установили службу SSHD.

<br>

- ![](images/8-2.png) 
Добавляем автостарт службы при загрузке системы командой `systemctl enable ssh`.

<br>

- ![](images/8-3.png)  
Запускаеv службу `systemctl start ssh`. Затем проверяем статус.

<br>

- ![](images/8-4.png) 
Настраиваем порт 2022 командой `nano /etc/ssh/sshd_config`.

<br>

- ![](images/8-5.png) 
`ps` - программа выводящая отчёт о работающих процессах, флаг `e` - выбрать все процессы, флаг `f` - вывести максимум доступных данных, например, количество потоков.

<br>

- ![](images/8-6.png)  
Перезапустили службу ssh. Далее использовали команду `netstat -tan`. Объясним каждое значение выведенной таблицы.
* флаг t - показать порты протокола TCP.

* флаг a - cписок всех портов.

* флаг n - показывать ip адреса в числовом виде.

* Proto - название протокола.

* Recv-Q -количество запросов в очередях на приём на данном узле/компьютере

* Send-Q -количество запросов в очередях на отправку на данном узле/компьютере.

* Local Address - IP адрес локального компьютера и номер используемого порта.

* Foreign Address - IP адрес и порт удаленного компьютера, к которому присоединен.

* State - Статус соединения по протоколу TCP.

* 0.0.0.0 - это специальный зарезервированный IP-адрес, который обозначает «все возможные адреса»*

<br>

## Part 9. Установка и использование утилит top, htop

- ![](images/9-1.png)  
* uptime - 8 часов, 29 минут.
* кол-во автроизированных пользователей - 1.
* общая загрузка системы - 0,00 0,00 0,00 за последние 15 минут.
* общее количество процессов - 98.
* загрузка cpu -  0.0 us, 0.0 sy, 0.0 ni,100 id, 0.0 wa, 0.0 hi, 3.8 si, 0.0 st. 
* загрузка памяти - MiB Mem & MiB Swap
* pid процесса занимающего больше всего памяти - 1.
* pid процесса, занимающего больше всего процессорного времени - 1.

<br>

- ![](images/9-2.png)  
Вывод htop отсортированный по PID (клавиша `f6`).

<br>

- ![](images/9-3.png)
Сортировка по PERCENT_CPU.

<br>

- ![](images/9-4.png)
Сортировка по PERCENT_MEM.

<br>

- ![](images/9-5.png)  
Сортировка по TIME.

<br>

- ![](images/9-6.png)  
Фильтр `f4` процесса sshd.

<br>

- ![](images/9-7.png)  
С помощью поиска `f3` нашли syslog.

<br>

- ![](images/9-8.png) 
Добавили вывод (`f2`) hostname, clock и uptime.

<br>

## Part 10. Использование утилиты fdisk

- ![](images/10-1.png)
Используем команду `fdisk -l`.
* Название жесткого диска: /dev/sda
* Размер жесткого диска: 11 GB
* Количество секторов: 23068672
* Размер раздела swap: 3670016 блоков. Так как размер блока по умолчанию составляет 512 байт, это составляет 3670016 * 512 = 1 879 048 192 байт или чуть меньше 2 GB.

<br>

## Part 11. Использование утилиты df

- ![](images/11-1.png)  
`df` для корневого раздела (/):
- размер раздела 9440580 байт
- размер занятого пространства 5151084 байт
- размер свободного пространства 3788352 байт
- процент использования 58%

    `df -Th` для корневого раздела (/):
- размер раздела 9.1 GB
- размер занятого пространства 5 GB
- размер свободного пространства 3.7 GB
- процент использования 58%
- тип файловой системы ext4

<br>

## Part 12. Использование утилиты du

- ![](images/12-1.png)  
Вывод команды du для папок /home, /var, /var/log и занимаемого места в ,байтах и человекочитаемом виде.

<br>

- ![](images/12-2.png)  
Вывели размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *).

<br>

## Part 13. Установка и использование утилиты ncdu

- ![](images/13-1.png)
Вывели размер папки home.

<br>

- ![](images/13-2.png)
Вывели размер папки var.

<br>

- ![](images/13-3.png)  
Вывели размер папки var/log.

<br>

## Part 14. Работа с системными журналами

- ![](images/14-1.png)  
Последняя успешная авторизация.

<br>

- ![](images/14-2.png)  
Перезагрузили службу sshd.

<br>

- ![](images/14-3.png)  
Выполните команду для просмотра логов, связанных с sshd `sudo journalctl -u ssh -e`.

<br>

## Part 15. Использование планировщика заданий CRON

- ![](images/15-1.png) 
Открываем файл cron и добавляем перезапуск службы каждые две минуты командой `crontab -e`.

<br>

- ![](images/15-2.png)  
Проверяем журнал.

<br>

- ![](images/15-3.png)  
Удаляем перезапуск службы.

<br>